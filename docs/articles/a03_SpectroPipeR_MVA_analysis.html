<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="SpectroPipeR">
<title>SpectroPipeR - step 3 -  MVA analysis • SpectroPipeR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="SpectroPipeR - step 3 -  MVA analysis">
<meta property="og:description" content="SpectroPipeR">
<meta property="og:image" content="https://stemicha.github.io/SpectroPipeR/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">SpectroPipeR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/a01_SpectroPipeR_read_Spectronaut_data.html">SpectroPipeR - step 1 - read Spectronaut data</a>
    <a class="dropdown-item" href="../articles/a02_SpectroPipeR_norm_quant.html">SpectroPipeR - step 2 - normalization and quantification</a>
    <a class="dropdown-item" href="../articles/a03_SpectroPipeR_MVA_analysis.html">SpectroPipeR - step 3 -  MVA analysis</a>
    <a class="dropdown-item" href="../articles/a04_SpectroPipeR_statistics.html">SpectroPipeR - step 4 - statistics</a>
    <a class="dropdown-item" href="../articles/a05_SpectroPipeR_reporting.html">SpectroPipeR - step 5 - reporting</a>
    <a class="dropdown-item" href="../articles/a06_SpectroPipeR_XIC_plot.html">SpectroPipeR - XIC plotting</a>
    <a class="dropdown-item" href="../articles/a07_Gprofiler2_code_suggestion.html">SpectroPipeR - stat. results functional enrichment analysis</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>SpectroPipeR - step 3 -  MVA analysis</h1>
            
      
      
      <div class="d-none name"><code>a03_SpectroPipeR_MVA_analysis.Rmd</code></div>
    </div>

    
    
<div id="Tip1" class="greeting message" style="color: blue;">
<p><strong>If you want to have a closer look at the images and plots
just do a “right-click” on the image and select “open in new
tab”</strong></p>
</div>
<div id="Tip2" class="greeting message" style="color: green;">
<p><strong>The output folders contained figures that were always
exported in two file formats: vector PDF and raster PNG.</strong></p>
<p><u>Recommendations for MacOS Users</u></p>
<p>For MacOS users, it is recommended to use the PDF files, for example
in Keynote, to achieve better quality.</p>
<p><u>Recommendations for Windows Users</u></p>
<p>For Windows users, it is recommended to use the PNG files, as
applications like Microsoft PowerPoint can sometimes have issues when
working with vector graphics.</p>
</div>
<div class="section level2">
<h2 id="spectropiper-mva-analysis">SpectroPipeR MVA analysis<a class="anchor" aria-label="anchor" href="#spectropiper-mva-analysis"></a>
</h2>
<p>Multivariate analysis (MVA) is particularly useful for analyzing
complex datasets, as it provides a deeper, more nuanced understanding of
the relationships between the samples.</p>
<div class="section level3">
<h3 id="background-information">background information<a class="anchor" aria-label="anchor" href="#background-information"></a>
</h3>
<p>The PCA analysis is performed on the normalized log<sub>2</sub>
peptide (peptide intensity) and log<sub>2</sub> protein (MaxLFQ or Hi3
intensity) level using all data. The principle component analysis for
peptide and protein level was done using the <a href="http://factominer.free.fr" class="external-link">factomineR package</a>, where data was
scaled to unit variance.</p>
<div class="section level4">
<h4 id="pca">PCA<a class="anchor" aria-label="anchor" href="#pca"></a>
</h4>
<p>PCA stands for Principal Component Analysis, which is a statistical
technique used to reduce the dimensionality of large data sets. It does
this by transforming a large set of variables into a smaller one that
still contains most of the information in the large set. This is
achieved by finding new variables, called principal components, that are
linear combinations of the original variables and capture as much of the
variation in the data as possible.</p>
<p>The first principal component captures the largest amount of
variation in the data, while each subsequent component captures the next
largest amount of variation.</p>
<p>A PCA plot is a visual representation of the results of a Principal
Component Analysis (PCA). It can help you understand the relationships
between the samples in your data by showing how they cluster together
based on their similarity.</p>
<p>Samples that are close together on the plot are similar to each
other, while samples that are far apart are dissimilar. The direction
and length of the arrows on the plot show how each variable contributes
to the first and second principal components.</p>
<p>The first and second dimensions of a PCA plot represent the first and
second principal components of the data, respectively. These are the two
directions in the data that capture the most variation. The first
principal component captures the largest amount of variation in the
data, while the second principal component captures the second largest
amount of variation.</p>
<div class="section level5">
<h5 id="hcpc">HCPC<a class="anchor" aria-label="anchor" href="#hcpc"></a>
</h5>
<p>If HCPC is selected a Hierarchical Clustering on Principle Components
will be performed using the metric “euclidean” and method “complete”.
The clustering tree is automatically cut at the suggested level (loss of
inertia).</p>
</div>
</div>
<div class="section level4">
<h4 id="umap">UMAP<a class="anchor" aria-label="anchor" href="#umap"></a>
</h4>
<p>UMAP stands for Uniform Manifold Approximation and Projection. It is
a dimension reduction technique that can be used for visualization
similarly to t-SNE, but also for general non-linear dimension reduction.
UMAP is a powerful tool for machine learning practitioners to visualize
and understand large, high dimensional datasets. It offers a number of
advantages over t-SNE, most notably increased speed and better
preservation of the data’s global structure.</p>
<p>To perform a UMAP analysis, the first step is to construct a
high-dimensional graph representation of the data. This is done by
finding the k-nearest neighbors for each data point and connecting them
with edges. The weight of each edge is determined by the distance
between the two points it connects. Next, a low-dimensional graph is
optimized to be as structurally similar as possible to the
high-dimensional graph. This is done using a stochastic gradient descent
algorithm that minimizes the cross-entropy between the two graphs.</p>
<p>The result of a UMAP analysis is a low-dimensional representation of
the data that can be visualized using a scatter plot. Each point on the
plot represents a sample, and its position reflects its values for the
first two or three principal components. Samples that are close together
on the plot are similar to each other, while samples that are far apart
are dissimilar.</p>
<p>In summary, UMAP analysis is performed by constructing a
high-dimensional graph representation of the data, then optimizing a
low-dimensional graph to be as structurally similar as possible. The
result is a low-dimensional representation of the data that can be
visualized and used to understand patterns and relationships in the
data.</p>
<p>The MVA_module() function will generate:</p>
<ol style="list-style-type: decimal">
<li>PCA analysis</li>
<li>(optional) HCPC (hierarchical clustering on principle components)
analysis, for more information see <a href="http://factominer.free.fr" class="external-link">factomineR</a>
</li>
<li>correlation analysis</li>
<li>UMAP analysis</li>
</ol>
</div>
</div>
<div class="section level3">
<h3 id="example-code">example code<a class="anchor" aria-label="anchor" href="#example-code"></a>
</h3>
<p><strong>MVA_module() needs the output of the norm_quant_module()
!</strong></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># step 3: MVA module</span></span>
<span><span class="fu"><a href="../reference/MVA_module.html">MVA_module</a></span><span class="op">(</span>SpectroPipeR_data_quant <span class="op">=</span> <span class="va">SpectroPipeR_data_quant</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="mva_module-outputs">MVA_module() outputs<a class="anchor" aria-label="anchor" href="#mva_module-outputs"></a>
</h3>
<p>The output in your specified output folder for the MVA_module()
function should look like in this example
(04_multivariate_analysis):</p>
<div class="float">
<img src="figures/folder_structure_MVA.png" style="width:50.0%" alt="MVA_module() outputs folder/files part 1"><div class="figcaption">MVA_module() outputs folder/files part 1</div>
</div>
<!-- figures MVA. Spectronaut data -->
<div class="section level4">
<h4 class="tabset tabset-pills" id="mva---rds-files">MVA - RDS files<a class="anchor" aria-label="anchor" href="#mva---rds-files"></a>
</h4>
<p>.rds files are a file format used in R to save and load single R
objects, such as data frames, models, or lists</p>
<p>The **PCA_analysis__peptide_level.RDS** data R object file contains
the PCA data on peptide level</p>
<p>The **PCA_analysis__protein_level.RDS** data R object file contains
the PCA data on protein level</p>
<p>The **UMAP_analysis__protein_level.RDS** data R object file contains
the UMAP data on protein level</p>
</div>
<div class="section level4">
<h4 class="tabset tabset-pills" id="mva---figures">MVA - figures<a class="anchor" aria-label="anchor" href="#mva---figures"></a>
</h4>
<div class="section level5">
<h5 id="correlation_plots">correlation_plots<a class="anchor" aria-label="anchor" href="#correlation_plots"></a>
</h5>
<p>The <strong>correlation_plots</strong> depicts the spearman
correlation score (closer to 1 = higher correaltion) on peptide and
protein level in a tile plot.</p>
<div class="float">
<img src="figures/03__correlation_plots.png" style="width:80.0%" alt="correlation with reordering"><div class="figcaption">correlation with reordering</div>
</div>
<div class="float">
<img src="figures/03__correlation_plots_condition" style="width:80.0%" alt="correlation plot sorted by conditions"><div class="figcaption">correlation plot sorted by conditions</div>
</div>
</div>
<div class="section level5">
<h5 id="d-pca_plots">3D PCA_plots<a class="anchor" aria-label="anchor" href="#d-pca_plots"></a>
</h5>
<p>The <strong>3D_PCA_plot__peptide_level.html</strong> and
<strong>3D_PCA_plot__protein_level.html</strong> are interactive 3D
representations of the 1st-2nd-3rd dimension of the PCA.</p>
</div>
<div class="section level5">
<h5 id="pca_plots">PCA_plots<a class="anchor" aria-label="anchor" href="#pca_plots"></a>
</h5>
<p>The <strong>PCA_plots</strong> encompass a series of graphical
representations, arranged from top to bottom. These include a scree
plot, a contribution plot, a PCA plot comparing the 1st and 2nd
dimensions, and a Biplot. The panel is divided into two sections: the
left side illustrates the peptide level, while the right side depicts
the protein level.</p>
<p>The scree plot is a visual tool that helps determine the optimal
number of components or factors to retain in multivariate analysis by
examining the pattern of explained variance across the different
components.</p>
<p>The contribution plot depicts the Top10 variable contributions in the
determination of a given principal component are (in percentage) :
(var.cos2 * 100) / (total cos2 of the component)</p>
<p>The PCA plot comparing the 1st and 2nd dimensions of the samples.</p>
<p>The biplot displays the relationships between samples and
proteins/peptides in a dataset.</p>
<p><img src="figures/03__PCA_plots.png" style="width:70.0%"></p>
</div>
<div class="section level5">
<h5 id="pca_plot_protein_level_conditions_marked">PCA_plot_protein_level_conditions_marked<a class="anchor" aria-label="anchor" href="#pca_plot_protein_level_conditions_marked"></a>
</h5>
<p>The <strong>PCA_plot_protein_level_conditions_marked</strong>
graphically represents the samples in the 1st and 2nd PCA dimensions at
the protein level, with colors indicating their respective
conditions.</p>
<p><img src="figures/03__PCA_plot_protein_level_conditions_marked.png" style="width:70.0%"></p>
</div>
<div class="section level5">
<h5 id="pca_plot_protein_level_replicates_marked">PCA_plot_protein_level_replicates_marked<a class="anchor" aria-label="anchor" href="#pca_plot_protein_level_replicates_marked"></a>
</h5>
<p>The <strong>PCA_plot_protein_level_replicates_marked</strong>
graphically represents the samples in the 1st and 2nd PCA dimensions at
the protein level, with colors indicating their respective conditions
and text labels indicating the replicates.</p>
<p><img src="figures/03__PCA_plot_protein_level_replicates_marked.png" style="width:70.0%"></p>
<p>The <strong>PCA_plot_1st_to_5th_dimension__protein_level</strong>
graphically represents the samples in the 1st to the 5th PCA dimensions
at the protein level, with colors indicating their respective
conditions.</p>
<p><img src="figures/03__PCA_plot_1st_to_5th_dimension__protein_level.png" style="width:70.0%"></p>
</div>
<div class="section level5">
<h5 id="pca_plot_protein_level_measurement_order">PCA_plot_protein_level_measurement_order<a class="anchor" aria-label="anchor" href="#pca_plot_protein_level_measurement_order"></a>
</h5>
<p>The <strong>PCA_plot_protein_level_conditions_marked</strong>
graphically represents the samples in the 1st and 2nd PCA dimensions at
the protein level, with colors indicating the measurement order.</p>
<p><img src="figures/03__PCA_plot_protein_level_measurement_order.png" style="width:70.0%"></p>
<p>The
<strong>PCA_plot_1st_to_5th_dimension__protein_level_measurement_order</strong>
graphically represents the samples in the 1st to the 5th PCA dimensions
at the protein level, with colors indicating the measurement order.</p>
<p><img src="figures/03__PCA_plot_1st_5th_protein_measurement_order.png" style="width:60.0%"></p>
</div>
<div class="section level5">
<h5 id="pca_plot_1st_to_5th_dimension__peptide_level">PCA_plot_1st_to_5th_dimension__peptide_level<a class="anchor" aria-label="anchor" href="#pca_plot_1st_to_5th_dimension__peptide_level"></a>
</h5>
<p>The <strong>PCA_plot_1st_to_5th_dimension__peptide_level</strong>
graphically represents the samples in the 1st to the 5th PCA dimensions
at the peptide level, with colors indicating their respective
conditions.</p>
<p><img src="figures/03__PCA_plot_1st_to_5th_dimension__peptide_level.png" style="width:60.0%"></p>
</div>
<div class="section level5">
<h5 id="pca_plot_1st_to_5th_dimension__peptide_level_measurement_order">PCA_plot_1st_to_5th_dimension__peptide_level_measurement_order<a class="anchor" aria-label="anchor" href="#pca_plot_1st_to_5th_dimension__peptide_level_measurement_order"></a>
</h5>
<p>The
<strong>PCA_plot_1st_to_5th_dimension__peptide_level_measurement_order</strong>
graphically represents the samples in the 1st to the 5th PCA dimensions
at the peptide level, with colors indicating the measurement order.</p>
<p><img src="figures/03__PCA_plot_1st_5th_peptide_measurement_order.png" style="width:60.0%"></p>
</div>
<div class="section level5">
<h5 id="umap_plot_protein_level_conditions_marked">UMAP_plot_protein_level_conditions_marked<a class="anchor" aria-label="anchor" href="#umap_plot_protein_level_conditions_marked"></a>
</h5>
<p>The <strong>UMAP_plot_protein_level_conditions_marked</strong>
graphically represents the samples in the UMAP dimensions at the protein
level, with colors indicating the measurement order.</p>
<p><img src="figures/03__UMAP_plot_protein_level_conditions_marked.png" style="width:60.0%"></p>
</div>
<div class="section level5">
<h5 id="hcpc---figures">HCPC - figures<a class="anchor" aria-label="anchor" href="#hcpc---figures"></a>
</h5>
<p>The HCPC performs an agglomerative hierarchical clustering on results
from a factor analysis.</p>
<p>In SpectroPipeR it is performed on peptide and protein level.</p>
<div class="float">
<img src="figures/03__HCPC_plots_peptide_level__2D_map.png" style="width:60.0%" alt="HCPC_plots_peptide_level__2D_map"><div class="figcaption">HCPC_plots_peptide_level__2D_map</div>
</div>
<div class="float">
<img src="figures/03__HCPC_plots_peptide_level__3D_map.png" style="width:60.0%" alt="HCPC_plots_peptide_level__3D_map"><div class="figcaption">HCPC_plots_peptide_level__3D_map</div>
</div>
<div class="float">
<img src="figures/03__HCPC_plots_peptide_level__barplot.png" style="width:60.0%" alt="HCPC_plots_peptide_level__barplot"><div class="figcaption">HCPC_plots_peptide_level__barplot</div>
</div>
<div class="float">
<img src="figures/03__HCPC_plots_peptide_level__tree_plot.png" style="width:60.0%" alt="HCPC_plots_peptide_level__tree_plot"><div class="figcaption">HCPC_plots_peptide_level__tree_plot</div>
</div>
<div class="float">
<img src="figures/03__HCPC_plots_protein_level__2D_map.png" style="width:60.0%" alt="HCPC_plots_protein_level__2D_map"><div class="figcaption">HCPC_plots_protein_level__2D_map</div>
</div>
<div class="float">
<img src="figures/03__HCPC_plots_protein_level__3D_map.png" style="width:60.0%" alt="HCPC_plots_protein_level__3D_map"><div class="figcaption">HCPC_plots_protein_level__3D_map</div>
</div>
<div class="float">
<img src="figures/03__HCPC_plots_protein_level__barplot.png" style="width:60.0%" alt="HCPC_plots_protein_level__barplot"><div class="figcaption">HCPC_plots_protein_level__barplot</div>
</div>
<div class="float">
<img src="figures/03__HCPC_plots_protein_level__tree_plot.png" style="width:60.0%" alt="HCPC_plots_protein_level__tree_plot"><div class="figcaption">HCPC_plots_protein_level__tree_plot</div>
</div>
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Stephan Michalik.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
