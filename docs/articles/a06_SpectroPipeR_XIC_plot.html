<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="SpectroPipeR">
<title>SpectroPipeR - XIC plotting • SpectroPipeR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="SpectroPipeR - XIC plotting">
<meta property="og:description" content="SpectroPipeR">
<meta property="og:image" content="https://stemicha.github.io/SpectroPipeR/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">SpectroPipeR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/a01_SpectroPipeR_read_Spectronaut_data.html">SpectroPipeR - step 1 - read Spectronaut data</a>
    <a class="dropdown-item" href="../articles/a02_SpectroPipeR_norm_quant.html">SpectroPipeR - step 2 - normalization and quantification</a>
    <a class="dropdown-item" href="../articles/a03_SpectroPipeR_MVA_analysis.html">SpectroPipeR - step 3 -  MVA analysis</a>
    <a class="dropdown-item" href="../articles/a04_SpectroPipeR_statistics.html">SpectroPipeR - step 4 - statistics</a>
    <a class="dropdown-item" href="../articles/a05_SpectroPipeR_reporting.html">SpectroPipeR - step 5 - reporting</a>
    <a class="dropdown-item" href="../articles/a06_SpectroPipeR_XIC_plot.html">SpectroPipeR - XIC plotting</a>
    <a class="dropdown-item" href="../articles/a07_Gprofiler2_code_suggestion.html">SpectroPipeR - stat. results functional enrichment analysis</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>SpectroPipeR - XIC plotting</h1>
            
      
      
      <div class="d-none name"><code>a06_SpectroPipeR_XIC_plot.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="spectropiper-xic-extraction-and-plotting">SpectroPipeR XIC extraction and plotting<a class="anchor" aria-label="anchor" href="#spectropiper-xic-extraction-and-plotting"></a>
</h2>
<div class="section level3">
<h3 id="introduction">introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h3>
<p>Evaluating results directly from raw data is highly recommended.
While the commercially licensed Spectronaut software offers this
functionality, the free Spectronaut Viewer can also be used for this
purpose. However, in proteomics research facilities, heavily utilized
full Spectronaut licenses can become a bottleneck for routine tasks like
XIC (Extracted Ion Chromatogram) inspection. To address this,
SpectroPipeR offers the ability to extract and plot XICs directly, if
the Spectronaut Pipeline analysis generated the corresponding SQLite
files per raw file. This setting can be found within Spectronaut and has
to be checked under “Pipeline Mode” settings.</p>
<div class="float">
<img src="figures/Spectronaut_xic_setting.png" style="width:80.0%" alt="Pipeline Mode setting for exporting the SQLite files per raw file"><div class="figcaption">Pipeline Mode setting for exporting the SQLite
files per raw file</div>
</div>
<p>If the Spectronaut analysis utilized the SpectroPipeR report export
scheme (accessible through the function
<code>Spectronaut_export_scheme(output_location = "../SpectroPipeR_test_folder")</code>)
and enabled XIC SQLite export, a separate folder containing individual
SQLite files for each raw file should be present within the Spectronaut
reporting folder.</p>
<p>In order to generate the XIC plots the user just have to point to the
Spectronaut report and the XIC SQLite folder to produce XIC pdf files
and if desired also ion specific csv files of the XICs.</p>
</div>
<div class="section level3">
<h3 id="example-code">example code<a class="anchor" aria-label="anchor" href="#example-code"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">SpectroPipeR</span><span class="op">)</span></span>
<span> <span class="co">#setup example input paths / protein selection for plotting</span></span>
<span> <span class="va">Spectronaut_report_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/HYE_demo_data"</span>,</span>
<span>                                        <span class="st">"HYE_demo_data_Report_SpectroPipeR.tsv"</span>,</span>
<span>                                         package<span class="op">=</span><span class="st">"SpectroPipeR"</span><span class="op">)</span></span>
<span> <span class="va">Spectronaut_xicDB_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/HYE_demo_data/XIC_DBs"</span>,package<span class="op">=</span><span class="st">"SpectroPipeR"</span><span class="op">)</span></span>
<span> <span class="va">protein_groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"P29311"</span>,<span class="st">"P38720"</span><span class="op">)</span></span>
<span> <span class="va">output_path</span> <span class="op">&lt;-</span> <span class="st">"../SpectroPipeR_test_folder/single_XIC_plots"</span></span>
<span></span>
<span> <span class="co"># extracting and plotting of XIC</span></span>
<span> <span class="fu"><a href="../reference/XIC_plot_module.html">XIC_plot_module</a></span><span class="op">(</span>Spectronaut_report_path <span class="op">=</span> <span class="va">Spectronaut_report_path</span>,</span>
<span>                 Spectronaut_xicDB_path <span class="op">=</span> <span class="va">Spectronaut_xicDB_path</span>,</span>
<span>                 protein_groups <span class="op">=</span> <span class="va">protein_groups</span>,</span>
<span>                 output_path <span class="op">=</span> <span class="va">output_path</span>,</span>
<span>                 export_csv_files <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 number_of_cores <span class="op">=</span> <span class="fl">2</span></span>
<span> <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#&gt; create output dir ...</span></span>
<span><span class="co">#&gt; loading Spectronaut report data ...</span></span>
<span><span class="co">#&gt; extract ion meta data from report ...</span></span>
<span><span class="co">#&gt; extract ion IDs of selected proteins groups ...</span></span>
<span><span class="co">#&gt;  [============================================================]  100.00% - XIC extraction... </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; add ion meta data to extracted XICs ...</span></span>
<span><span class="co">#&gt; register processor cores</span></span>
<span><span class="co">#&gt; plotting (this might take a while) ...</span></span>
<span><span class="co">#&gt;   |============================================================| 100%</span></span>
<span><span class="co">#&gt; DONE ...</span></span></code></pre></div>
<p>In the output folder the user can find plots and csv files of the
protein group selected ion XICs (MS1/MS2).</p>
<div class="float">
<img src="figures/XIC_example.png" style="width:90.0%" alt="example plot output of the XIC_plot_module() function"><div class="figcaption">example plot output of the XIC_plot_module()
function</div>
</div>
</div>
<div class="section level3">
<h3 id="explanation-of-depicted-scores">explanation of depicted scores<a class="anchor" aria-label="anchor" href="#explanation-of-depicted-scores"></a>
</h3>
<p>Description of the Spectronaut scores shown in the output plots:</p>
<table class="table">
<colgroup>
<col width="20%">
<col width="79%">
</colgroup>
<thead><tr class="header">
<th align="left"><u> <strong>parameter</strong> </u></th>
<th align="left"><u> <strong>description</strong> </u></th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">EG.Qvalue</td>
<td align="left">The Q-value is the multiple test corrected p-value. The
Q-value can be used as an estimate for the FDR at a given Cscore
cutoff.</td>
</tr>
<tr class="even">
<td align="left">EG.PEP</td>
<td align="left">The posterior error probability for a peptide precursor
observation. The PEP is calculated as the decoy probability function for
a specficic Cscore divided by the probability function for decoy plus
target. PEP = d/(t+d) where d is the value of the decoy probability
function for a given Cscore and t is the value for target probability
function for a given Cscore.</td>
</tr>
<tr class="odd">
<td align="left">FG.ShapeQualityScore</td>
<td align="left">The average of all available peak quality measurements
(scale: 1.0 <code>best</code> to -1.0 <code>worst</code>)</td>
</tr>
<tr class="even">
<td align="left">EG.IntCorrScore</td>
<td align="left">The correlation score between the relative fragment
intensities as provided by the spectral librarxy and the empirical
observed fragtment intensitiers at XIC peak apex.</td>
</tr>
<tr class="odd">
<td align="left">EG.SignalToNoise</td>
<td align="left">The signal to noise ratio of the LC-MS peak for a given
peptide precursor. The signal is calc. as the maximum intensity of the
fragment sum XIC within the peak boundaries. The noise is calculated as
the average fragment sum XIC intensity outside the peak boundaries.</td>
</tr>
<tr class="even">
<td align="left">EG.Cscore</td>
<td align="left">The discriminant score used for identification. This
score is a linear combination of all applicable scores for a certain
workflow.</td>
</tr>
<tr class="odd">
<td align="left">EG.Identified</td>
<td align="left">Returns weather a precursor is considered identified or
not. In order to be identified it has to match both the precursor and
the protein FDR cutoff.</td>
</tr>
<tr class="even">
<td align="left">dppp (MS1)</td>
<td align="left">Returns the number of data points (scans) that make up
the MS1 XIC of the selected LC-MS peak for this precursor. Only data
points that lie within the start and the end RT are considered.</td>
</tr>
<tr class="odd">
<td align="left">dppp (MS2)</td>
<td align="left">Returns the number of data points (scans) that make up
the MS2 XIC of the selected LC-MS peak for this precursor. Only data
points that lie within the start and the end RT are considered.</td>
</tr>
</tbody>
</table>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Stephan Michalik.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
