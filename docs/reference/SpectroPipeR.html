<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Function for performing the whole SpectroPipeR analysis workflow."><title>SpectroPipeR: complete Spectronaut analysis with one function — SpectroPipeR • SpectroPipeR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="SpectroPipeR: complete Spectronaut analysis with one function — SpectroPipeR"><meta property="og:description" content="Function for performing the whole SpectroPipeR analysis workflow."><meta property="og:image" content="https://stemicha.github.io/SpectroPipeR/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">SpectroPipeR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/a01_SpectroPipeR_read_Spectronaut_data.html">SpectroPipeR - step 1 - read Spectronaut data</a>
    <a class="dropdown-item" href="../articles/a02_SpectroPipeR_norm_quant.html">SpectroPipeR - step 2 - normalization and quantification</a>
    <a class="dropdown-item" href="../articles/a03_SpectroPipeR_MVA_analysis.html">SpectroPipeR - step 3 -  MVA analysis</a>
    <a class="dropdown-item" href="../articles/a04_SpectroPipeR_statistics.html">SpectroPipeR - step 4 - statistics</a>
    <a class="dropdown-item" href="../articles/a05_SpectroPipeR_reporting.html">SpectroPipeR - step 5 - reporting</a>
    <a class="dropdown-item" href="../articles/a06_SpectroPipeR_XIC_plot.html">SpectroPipeR - XIC plotting</a>
    <a class="dropdown-item" href="../articles/a07_Gprofiler2_code_suggestion.html">SpectroPipeR - stat. results functional enrichment analysis</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>SpectroPipeR: complete Spectronaut analysis with one function</h1>
      
      <div class="d-none name"><code>SpectroPipeR.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Function for performing the whole SpectroPipeR analysis workflow.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">SpectroPipeR</span><span class="op">(</span></span>
<span>  file <span class="op">=</span> <span class="st">""</span>,</span>
<span>  parameter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  max_chars_file_name_capping <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  ID_condition_filtering <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  ID_condition_filtering_percent <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  batch_adjusting <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  sample__batch_meta_data_file <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  batch_adjusting_column <span class="op">=</span> <span class="st">""</span>,</span>
<span>  number_of_cores_adjusting <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span>,</span>
<span>  covariate_adjusting_formula <span class="op">=</span> <span class="st">""</span>,</span>
<span>  covariate_adjusting_meta_data_file <span class="op">=</span> <span class="st">""</span>,</span>
<span>  skipping_MaxLFQ_median_norm <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  HCPC_analysis <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  costum_colors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  condition_comparisons <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  number_of_cores_statistics <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  build_HTML_report <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>file</dt>
<dd><p>location (path) of Spectronaut output report;
you should use the <code><a href="Spectronaut_export_scheme.html">Spectronaut_export_scheme()</a></code> function for getting a SpectroPipeR report scheme encompassing all mandatory columns</p></dd>


<dt>parameter</dt>
<dd><p><strong>mandatory parameter list element</strong></p>
<p><em>table of list elements:</em></p><table class="table table"><tr><td><u> <strong>parameter</strong> </u></td><td><u> <strong>description</strong> </u></td></tr><tr><td>output_folder</td><td><em>character</em> - output folder path (abs.)</td></tr><tr><td>ion_q_value_cutoff</td><td><em>numeric</em> - Q-value used in Spectronaut analysis: Biognosys</td></tr><tr><td></td><td>default is 0.01 = 1% error rate</td></tr><tr><td>id_drop_cutoff</td><td><em>numeric</em> - value between 0-1 (1 = 100%); xx percent lower</td></tr><tr><td></td><td>than median of ion ID rate =&gt; outlier</td></tr><tr><td>normalization_method</td><td><em>character</em> - "median" or Spectronaut - auto-detection is per</td></tr><tr><td></td><td>default ON, meaning if normalization was performed in Spectronaut</td></tr><tr><td></td><td>this will be detected and preferred over parameter setting here;</td></tr><tr><td></td><td>median normalization is the fallback option</td></tr><tr><td>normalization_factor_cutoff_outlier</td><td><em>numeric</em> - median off from global median</td></tr><tr><td></td><td>(4 means abs. 4fold off)</td></tr><tr><td>filter_oxidized_peptides</td><td><em>logical</em> - if oxidized peptides should be removed from peptide</td></tr><tr><td></td><td>quantification</td></tr><tr><td>protein_intensity_estimation</td><td><em>character</em> - Hi3 = Hi3 protein intensity estimation,</td></tr><tr><td></td><td>MaxLFQ = MaxLFQ protein intensity estimation</td></tr><tr><td>stat_test</td><td><em>character</em> - choose statistical test: "rots" = reproducibility</td></tr><tr><td></td><td>optimized test statistics, "modt" = moderate t-test (lmfit, eBayes),</td></tr><tr><td></td><td>"t" = t-test</td></tr><tr><td>type_slr</td><td><em>character</em> - choose ratio aggregation method: "median" or "tukey"</td></tr><tr><td></td><td>is used when calculating protein values</td></tr><tr><td>fold_change</td><td><em>numeric</em> - fold-change used as cutoff e.g. 1.5</td></tr><tr><td>p_value_cutoff</td><td><em>numeric</em> - p-value used as cutoff e.g. 0.05</td></tr><tr><td>paired</td><td><em>logical</em> - Should paired statistics be applied?</td></tr></table><table class="table table"><tr><td><u>example parameters list</u>:</td></tr><tr><td>params &lt;- list(output_folder = "../Spectronaut_example",</td></tr><tr><td>ion_q_value_cutoff = 0.001,</td></tr><tr><td>id_drop_cutoff = 0.3,</td></tr><tr><td>normalization_method = "median",</td></tr><tr><td>normalization_factor_cutoff_outlier = 4,</td></tr><tr><td>filter_oxidized_peptides = T,</td></tr><tr><td>protein_intensity_estimation = "MaxLFQ",</td></tr><tr><td>stat_test = "modt",</td></tr><tr><td>type_slr = "median",</td></tr><tr><td>fold_change = 1.5,</td></tr><tr><td>p_value_cutoff = 0.05,</td></tr><tr><td>paired = FALSE</td></tr><tr><td>)</td></tr><tr><td></td></tr></table></dd>


<dt>max_chars_file_name_capping</dt>
<dd><p>integer, (default = 25) number of max characters used for raw file name presentation; must be adjusted if function</p></dd>


<dt>ID_condition_filtering</dt>
<dd><p>TRUE or FALSE if a condition-wise filtering should be performed</p></dd>


<dt>ID_condition_filtering_percent</dt>
<dd><p>(numerical value ranging from 0 - 1, default = 0.5) define the proportion for the condition-wise ID filtering</p></dd>


<dt>batch_adjusting</dt>
<dd><p>logical - if batch adjusting with ComBat (sva package) should be performed; default = FALSE</p></dd>


<dt>sample__batch_meta_data_file</dt>
<dd><p>character - sample batch file; tab-delimited txt-file, containing "R.FileName" column e.g. sample__batch_meta_data_file = "Sample_MetaData_Batches.txt"</p>
<p><em>example table for batch meta data:</em></p><table class="table table"><tr><td><u> <strong>R.FileName</strong> </u></td><td><u> <strong>digest_batch</strong> </u></td></tr><tr><td>20230403_TIMSTOF_1_S1-B11_1_6690</td><td>1</td></tr><tr><td>20230403_TIMSTOF_2_S1-G11_1_6695</td><td>1</td></tr><tr><td>20230403_TIMSTOF_3_S1-E7_1_6661</td><td>1</td></tr><tr><td>20230403_TIMSTOF_4_S1-A9_1_6673</td><td>2</td></tr><tr><td>20230403_TIMSTOF_7_S1-D8_1_6668</td><td>2</td></tr><tr><td>20230403_TIMSTOF_9_S1-D3_1_6627</td><td>2</td></tr></table><p><strong>A good starting point for the generation of the table is the '*_ConditionSetup.tsv' in your Spectronaut Pipeline Report export folder</strong></p></dd>


<dt>batch_adjusting_column</dt>
<dd><p>character - column name in sample__batch_meta_data_file, which should be used for assigning the samples to batches</p></dd>


<dt>number_of_cores_adjusting</dt>
<dd><p>numeric - number of processor cores used for batch or covariate adjustment</p></dd>


<dt>covariate_adjusting_formula</dt>
<dd><p>character - provide a formula passed to lm() for covariate adjustment e.g. "log10_peptide_intensity ~ log10(CRP)+log10(age)+as.factor(sex)"; you may also use ns() function e.g. "log10_peptide_intensity ~ ns(age, df=3)"</p></dd>


<dt>covariate_adjusting_meta_data_file</dt>
<dd><p>covariate meta csv file, containing "R.FileName; age; sex;..."; you may find a start file in the 02_ID_rate folder &gt; file_list.csv column e.g. covariate_adjusting_meta_data_file = "covariate_MetaData_file.csv"
<em>example table for covariate meta data:</em></p><table class="table table"><tr><td><u> <strong>R.FileName</strong> </u></td><td><u> <strong>R.Condition</strong> </u></td><td><u> <strong>sex</strong> </u></td><td><u> <strong>CRP</strong> </u></td></tr><tr><td>20230403_TIMSTOF_1_S1-B11_1_6690</td><td>heathy</td><td>1</td><td>3.8</td></tr><tr><td>20230403_TIMSTOF_2_S1-G11_1_6695</td><td>heathy</td><td>2</td><td>5.1</td></tr><tr><td>20230403_TIMSTOF_3_S1-E7_1_6661</td><td>heathy</td><td>1</td><td>1.2</td></tr><tr><td>20230403_TIMSTOF_4_S1-A9_1_6673</td><td>cancer</td><td>1</td><td>50.2</td></tr><tr><td>20230403_TIMSTOF_7_S1-D8_1_6668</td><td>cancer</td><td>2</td><td>30.8</td></tr><tr><td>20230403_TIMSTOF_9_S1-D3_1_6627</td><td>cancer</td><td>2</td><td>64.1</td></tr></table></dd>


<dt>skipping_MaxLFQ_median_norm</dt>
<dd><p>logical - if median normalization after MaxLFQ calculation should be skipped; default = FALSE; applied only if MaxLFQ protein estimation is selected</p></dd>


<dt>HCPC_analysis</dt>
<dd><p>boolean; should a HCPC be performed or not</p></dd>


<dt>costum_colors</dt>
<dd><p>if you would like to use your own colors for condition coloring please provide a named color vector (e.g. c(condition1 = "black", condition2 = "grey")); names should have the same naming and length like the conditions set in Spectronaut</p></dd>


<dt>condition_comparisons</dt>
<dd><p>condition comparisons for pairwise- comparison; e.g. condition_comparisons &lt;- cbind(c("condition1","control"),c("condition3","control") )</p></dd>


<dt>number_of_cores_statistics</dt>
<dd><p>number of processor cores to be used for the calculations default = 2;</p>
<p><code>parallel::detectCores()-2</code> for faster processing (will detect the number of cores in the system and use nearly all cores)</p></dd>


<dt>build_HTML_report</dt>
<dd><p>boolean; if a HTML report of the analysis should be generated or not</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>SpectroPipeR list object containing tables and plots of the analysis in addition to the automatically saved tables and plots.
For the description of the generated figures and tables please read the manual &amp; vignettes</p>


<p><strong>The SpectroPipeR list element contains:</strong></p>


<ul><li><p>SpectroPipeR_data</p></li>
<li><p>SpectroPipeR_data_quant</p></li>
<li><p>SpectroPipeR_data_MVA</p></li>
<li><p>SpectroPipeR_data_stats</p></li>
</ul><p><strong>SpectroPipeR_data:</strong></p><table class="table table"><tr><td><u> <strong>list element</strong> </u></td><td><u> <strong>description</strong> </u></td></tr><tr><td>spectronaut_output</td><td><em>tibble:</em> Spectronaut report tibble provided for the analysis</td></tr><tr><td>SDRF_file</td><td><em>tibble:</em> intermediate SDRF table of the analysis</td></tr><tr><td>summary_distinct</td><td><em>tibble:</em> distinct ion, modified peptide, stripped peptides and</td></tr><tr><td></td><td>protein group count per file filtered by provided Q-value</td></tr><tr><td>raw_file_names</td><td><em>tibble:</em> R.FileNames capped and uncapped version together with</td></tr><tr><td></td><td>R.Condition and R.Replicate</td></tr><tr><td>ion_id_median</td><td><em>numerical value:</em> median of ion intensity</td></tr><tr><td>ion_id_cutoff</td><td><em>numerical value:</em> ion ID count threshold to classify sample as outlier</td></tr><tr><td>PG_2_peptides_ID_raw</td><td><em>tibble:</em> with protein groups with at least 2 peptides with peptide</td></tr><tr><td></td><td>and replicate count</td></tr><tr><td>summary_distinct_outlier</td><td><em>tibble:</em> if outlier are detected they are listed in this tibble</td></tr><tr><td>ID_rate_plot</td><td><em>ggplot2 plot:</em> ID rate plot</td></tr><tr><td>ID_rate_plot_filter</td><td><em>ggplot2 plot:</em> ion ID rate plot with ion ID cutoff line</td></tr><tr><td>sample_length</td><td><em>numberical value:</em> number of samples in the provided Spectronaut report</td></tr><tr><td>parameter</td><td><em>list:</em> parameters provided by the user</td></tr><tr><td>time_stamp_log_file</td><td><em>string:</em> time stamp of the log file (format: %Y_%m_%d__%H_%M)</td></tr><tr><td>log_file_name</td><td><em>string:</em> analysis log file name</td></tr></table><p><strong>SpectroPipeR_data_quant:</strong></p><table class="table table"><tr><td><u> <strong>list element</strong> </u></td><td><u> <strong>description</strong> </u></td></tr><tr><td>data_input_normalized</td><td><em>tibble:</em> Spectronaut report tibble provided for the analysis</td></tr><tr><td>MedianNormalizationFactor</td><td><em>tibble:</em> ion normalization factor table</td></tr><tr><td>MedianNormalizationFactor_outlier</td><td><em>tibble:</em> table containing detected norm. outliers on ion level</td></tr><tr><td>NormFactor_plot</td><td><em>ggplot2 plot:</em> norm. factor plots</td></tr><tr><td>iBAQ_intensities</td><td><em>tibble:</em> table containing the iBAQ int.</td></tr><tr><td>iBAQ_intensities_summary</td><td><em>tibble:</em> table containing the per condition summarized iBAQ int.</td></tr><tr><td>protein_data</td><td><em>tibble:</em> protein intensity table (e.g. Hi3 or MaxLFQ int.)</td></tr><tr><td>PG_2_peptides_ID_raw</td><td><em>tibble:</em> with protein groups with at least 2 peptides with peptide</td></tr><tr><td></td><td>and replicate count</td></tr><tr><td>protein_data_normalization_factor</td><td><em>tibble:</em> normalization factor table for protein int. data</td></tr><tr><td>peptide_intensity_filtered_2pep_hi3</td><td><em>tibble:</em> if Hi3 protein int. was selected a table containing</td></tr><tr><td></td><td>the peptides and intensities used for Hi3 protein intensity calculation</td></tr><tr><td>peptide_intensity</td><td><em>tibble:</em> peptides intensity table based on norm. ion intensity</td></tr><tr><td>parameter</td><td><em>list:</em> parameters provided by the user updated with the</td></tr><tr><td></td><td>norm_quant_module() parameters</td></tr><tr><td>CV_cumulative_frequency</td><td><em>tibble:</em> cumulative frequency table on peptide</td></tr><tr><td></td><td>and protein intensity level</td></tr><tr><td>sample_length</td><td><em>numberical value:</em> number of samples in the provided Spectronaut report</td></tr></table><p><strong>SpectroPipeR_data_MVA:</strong></p><table class="table table"><tr><td><u> <strong>list element</strong> </u></td><td><u> <strong>description</strong> </u></td></tr><tr><td>PCA_peptide_intensity</td><td><em>PCA list element:</em> PCA list element of peptide int.</td></tr><tr><td>PCA_protein_intensity</td><td><em>PCA list element:</em> PCA list element of protein int.</td></tr><tr><td>UMAP_protein_intensity</td><td><em>umap element:</em> UMAP element of protein int.</td></tr><tr><td>peptide_intensity_correlation</td><td><em>matrix:</em> Spearman correlation scores of peptide int.</td></tr><tr><td>protein_intensity_correlation</td><td><em>matrix:</em> Spearman correlation scores of protein int.</td></tr></table><p><strong>SpectroPipeR_data_stats:</strong></p><table class="table table"><tr><td><u> <strong>list element</strong> </u></td><td><u> <strong>description</strong> </u></td></tr><tr><td>stat_results</td><td><em>tibble:</em> statistical analysis results table</td></tr><tr><td>stat_column_description</td><td><em>tibble:</em> statistical analysis results table column description</td></tr><tr><td>stats_results_iBAQ_quantiles</td><td><em>tibble:</em> statistical analysis results table containing</td></tr><tr><td></td><td>the iBAQ quantilies (Q1-Q10) of the protein per group for a better</td></tr><tr><td></td><td>ratio judgement</td></tr><tr><td>stat_results_filtered</td><td><em>tibble:</em> filtered (user defined FC and adj. p-value) statistical</td></tr><tr><td></td><td>analysis results table</td></tr></table></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><strong>batch adjustment</strong></p>
<p>Batch effects refer to systematic differences between batches (groups) of samples in high-throughput experiments.
These differences can arise due to various factors, such as batch variations in sample preparation, handling, processing
procedures and measurement orders. Batch effects can obscure the true biological signal and lead to incorrect conclusions
if not properly accounted for.
In the SpectroPipeR pipeline, the ComBat tool was employed to adjust for batch effects in the datasets where the batch
covariate was known. ComBat utilizes the methodology described in <a href="https://pubmed.ncbi.nlm.nih.gov/16632515/" class="external-link">Johnson et al. 2007</a>.
It uses an empirical Bayes (EB) framework for adjusting data for batch effects that is robust to outliers in small sample sizes
and performs comparable to existing methods for large samples. <a href="https://pubmed.ncbi.nlm.nih.gov/16632515/" class="external-link">Johnson et al. 2007:</a>
This method incorporates systematic batch biases common across genes in making adjustments, assuming that phenomena resulting in
batch effects often affect many genes in similar ways (i.e. increased expression, higher variability, etc). Specifically, the
the L/S model parameters are estimated that represent the batch effects by pooling information across peptides in each
batch to shrink the batch effect parameter estimates toward the overall mean of the batch effect estimates (across genes).
These EB estimates are then used to adjust the data for batch effects, providing more robust adjustments for the batch effect on each peptide.
In SpectroPipeR a parametric ComBAT emperical Bayes adjustment is implemented by utilizing the sva-package.</p>
<p><strong>covariate adjustment</strong></p>
<p>If a covariate adjustment of peptide intensity data was performed using the users input formula,
a linear mixed model (LMM) was calculated based on that formula per peptide and the outcoming
residuals were added to the mean peptide intensity over the samples. This means that the adjusted
peptide intensities retain their intensity level (low intense peptides keep their low intensity and
high intense ions keep their higher intensity).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># load library</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">SpectroPipeR</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># parameter list</span></span>
<span><span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>output_folder <span class="op">=</span> <span class="st">"../SpectroPipeR_test_folder"</span>,</span>
<span>              ion_q_value_cutoff <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>              id_drop_cutoff <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>              normalization_method <span class="op">=</span> <span class="st">"median"</span>,</span>
<span>              normalization_factor_cutoff_outlier <span class="op">=</span> <span class="fl">4</span>,</span>
<span>              filter_oxidized_peptides <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>              protein_intensity_estimation <span class="op">=</span> <span class="st">"MaxLFQ"</span>,</span>
<span>              stat_test <span class="op">=</span> <span class="st">"modt"</span>,</span>
<span>              type_slr <span class="op">=</span> <span class="st">"median"</span>,</span>
<span>              fold_change <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>              p_value_cutoff <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>              paired <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>             <span class="op">)</span></span>
<span></span>
<span><span class="co"># example input file</span></span>
<span><span class="va">example_file_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span>
<span>                                <span class="st">"SN_test_HYE_mix_file.tsv"</span>,</span>
<span>                                package<span class="op">=</span><span class="st">"SpectroPipeR"</span><span class="op">)</span></span>
<span><span class="co"># perform the analysis</span></span>
<span><span class="va">SpectroPipeR_analysis</span> <span class="op">&lt;-</span> <span class="fu">SpectroPipeR</span><span class="op">(</span>file <span class="op">=</span> <span class="va">example_file_path</span>,</span>
<span>                                     parameter <span class="op">=</span> <span class="va">params</span>,</span>
<span>                                     condition_comparisons <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"HYE mix A"</span>,<span class="st">"HYE mix B"</span><span class="op">)</span><span class="op">)</span></span>
<span>                                     <span class="op">)</span></span>
<span></span></code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Stephan Michalik.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

